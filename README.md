HTM

Simple implementation of [Indexing the Sphere with the Hierarchical Triangular Mesh](https://arxiv.org/pdf/cs/0701164.pdf)

### Functionailty

The HTM object is built from an integer i >= 0

```c++
HTM htm
htm.build(i);
```

![Example Builds](https://github.com/harveydevereux/HTM/blob/master/tests/ExampleHTMs.png)

leaves can be accessed as a vector of Trixels

```c++
vector< Trixel <double> > htm.leaves();
```

and saved to a csv with one trixel per line (in D dimensions 3D coordinates and the ID)
```c++
htm.writeLeaves(filename);
```

### Classes

- Triangle template class represents a simplex of any dimension as three vectors x, y, z for it's vertices
- can calculate the area in the 3D case 
```c++
template <class T>
class Triangle {
protected:
  size_t dimension;                                                             
  vector<T> x;                                                                  
  vector<T> y;
  vector<T> z;
  ...
```

- Trixel inherits Triangle and adds a unique name (generated by HTM and an integer to represent the parent
and a vector of integers to represent children (via HTM)
```c++
template <class T>
class Trixel: public Triangle<T> {                                              
private:                                                                         
  string ID;                                                                    
  int parent;
  vector<int> children;
  ...
```

- HTM a depth and a vector of Trixels, the mesh is build from the public build() member
```c++
class HTM{
private:
  size_t depth;
  vector< Trixel <double> > Mesh;
  ...
```

### Utilities

- rayIn3DTriangle: determine if a ray defined by the star and end points p and q will intersect a Triangle if
  extended in the direction from p to q
```c++
template <class T, class T2>                                                    
uint8_t rayIn3DTriangle(vector<T> p, vector<T> q, Triangle<T2> tri){ 
...
```
